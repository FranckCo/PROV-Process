@prefix ex-act: <http://example.org/linkage/activity/> .
@prefix ex: <http://example.org/linkage/> .
@prefix ex-prod: <http://example.org/linkage/product/> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dqm: <http://purl.org/dqm-vocabulary/v1/dqm#> .

# Candidate pairs to linkage keys

# Fully defined in fragment 3, repeated here for completeness, name can change
# Is this one data set or several?
ex-prod:indexesBlocks a prov:Entity ;
        rdfs:label "Indexes/Blocks"@en .

ex-prod:comparisonOutcomes a prov:Entity ;
        rdfs:label "Comparison outcomes"@en .

# Do we need comparisonOutcomesGeneration?
# Shouldn't we also have prov:wasDerivedFrom ex-prod:comparisonOutcomes?
ex-prod:linkageKeys a prov:Entity ;
        rdfs:label "Linkage keys"@en ;
        prov:wasDerivedFrom ex-prod:indexesBlocks ;
        prov:qualifiedDerivation [
             a prov:Derivation ;
             prov:entity ex-prod:indexesBlocks ;
             prov:hadActivity ex-act:compareAttributes ;
             prov:hadGeneration ex:comparisonOutcomesGeneration ;
        ] ;
        prov:qualifiedDerivation [
             a prov:Derivation ;
             prov:entity ex-prod:comparisonOutcomes ;
             prov:hadActivity ex-act:makeLinkageDecisionsDeterministic ;
             prov:hadActivity ex-act:makeLinkageDecisionsProbalistic ;
        ] .

ex-act:compareAttributes a prov:Activity ;
        rdfs:label "Compare attributes"@en .

ex:comparisonOutcomesGeneration a prov:Generation ;
        rdfs:label "Comparison outcomes generation"@en ;
        prov:activity ex-act:compareAttributes .
		
# Review naming (esp. name order)
ex-act:makeLinkageDecisionsDeterministic a prov:Activity ;
        rdfs:label "Make linkage decisions deterministic"@en ;
        prov:used ex-prod:logicalConditions .

ex-act:makeLinkageDecisionsProbalistic a prov:Activity ;
        rdfs:label "Make linkage decisions probabilistic"@en ;
        prov:used ex-prod:totalLinkageWeightPairs .

ex-prod:logicalConditions a prov:Entity , dqm:ConditionalRule ;
        prov:wasGeneratedBy ex-act:makeLinkageDecisionsDeterministic ;
        prov:qualifiedGeneration [
             a prov:Generation ;
             prov:activity ex-act:makeLinkageDecisionsDeterministic ;
             rdfs:comment "These logical conditions are developed iteratively using manual reviews on samples of pairs."@en ;
        ] .

ex-prod:totalLinkageWeightPairs a prov:Entity , dqm:DataQualityScore ;
        prov:wasGeneratedBy ex-act:makeLinkageDecisionsProbalistic ;
        prov:qualifiedGeneration [
             a prov:Generation ;
             prov:activity ex-act:makeLinkageDecisionsProbalistic ;
             rdfs:comment "The total weight is compared to two thresholds to make decisions as to whether the pair represents a match or non-match. Pairs with a weight between the two thresholds are resolved manually."@en ;
        ] .		